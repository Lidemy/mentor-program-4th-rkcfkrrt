# 部署心得

## 主機選擇
最初從選擇主機開始，搜尋各家主機的比較，發現有 87% 的內容都看不懂，應該先補一點基礎知識，像是自我檢測 P1 的部份。

對一些名詞與架構有點印象與理解後，資料看著看著又陷入選擇困難，各家都有有趣的東西想來試試。考慮到畢竟是新手，過程應該有很多撞牆的地方，於是選可以查到超多中英文資料且市佔率高的老牌主機 AWS 吧；另一方面也是考慮到履歷上可以放上網站部署相關內容，去人力銀行偷看了一下有的職缺也會提到，而 AWS 也是目前佔比最高的。

## 購買網域
在完成購買主機，回去看本週課程介紹，注意到還要購買網域。

有點在意的是，gandi 贊助的網域折扣碼，隱約記得去年底有看到老師開放讓大家領即將於年底過期的折扣碼，究竟年初的現在還有沒有呢！

一邊糾結一邊先打開了 gandi 看看域名們，有一些很有趣的域名，像是 .osaka，還有不同語言的，像是 .कॉम（梵文的 .com）、日文的 .みんな。差點要買下 .art 了，~~因為它在特價，~~可是域名的選擇最好還是跟自己的網站有點關係，不禁思考起我從今天起走 art 路線還來得及嗎？再看到 gandi 前陣子有歡慶 20 週年的系列活動，錯過玩遊戲獲得折扣的機會，也是有些悲傷。

想了想，為了年前爆買年貨或用買快樂的名義買下各種快樂而削瘦的錢包，好像還是該來問一下折扣碼的事情，大不了等到第五期進來的時候也可能會有吧嗚嗚嗚。

還好詢問老師和助教後拿到折扣碼，還順便幫我解決域名選擇的問題，因為它的折扣是給 .tw 的。
總之，感謝 gandi 的贊助！！！唯一覺得有點神祕的是，折扣碼只能用在一年的選項，選兩年會是兩年原價，並不會折扣一年的錢 XDD

## 從 EC2 開始
對我而言，最大的困難點在於不知道自己要幹嘛，像是剛申請完帳號、看著 AWS 的服務清單，只覺被滿坑滿谷的未知包圍，資料雖然很多，卻得花不少時間才能理解、接著辨識出哪些是合用的。當然，可以直接挖同學、學長姊以及本週的參考資料來看，不過若能靠自己完成自然是最好的，當時是這樣希望的XDD

一開始先透過 AWS 提供的課程，亂玩一些簡單的功能，像是託管靜態網站和 AWS Amplify；脫離「這裡是哪裡、我是誰」的狀態後，總算可以比較進入狀況，好好面對真正要做的事，也就是網站部署。

從眾多資料中了解到啟用 EC2 是網站部署重要的基礎，它的設定雖然步驟不少，但說明清楚，且如果想走免費方案，它大多有提示哪些選項是免費的範圍，跟著走就對了。

在選擇 Ubuntu 時，記得之前有看到建議說考慮到安全修復等問題應選最新的版本，於是看到 20.04 的版本就開心地選下去，後來翻同學的心得當參考時看到他提到他選的是 18.04，原因在於推出時間比較久，所以資料應該會更多。真有道理！可惜當時我已來不及，也還好暫時沒遇到找不到資料幫助解決的問題。

接下來便有些困擾，照本來的思路，作法是摸熟網路架構並把重要服務串連，所以接下來要來試試資料庫，也就是 RDS 的部份。但來到這一步已經快花上一週了，突然開始懷疑自己到底有沒有走在正確的方向上，便決定去看看同學們的筆記，參考一下步驟。

## 不小心就做完了
去翻了 Heidi 同學的筆記 aka 最愛的筆記之一（還有另外幾個同學的也好喜歡），一打開便看到他列出的部署流程，感恩 Heidi，讚嘆 Heidi。

跟著流程做著做著，就，做完了，好像還是參考太多人家的東西了囧真可惜！不過大家遇上的問題不太一樣呢，相仿的步驟，卻不一定會遇上一樣的問題，也是頗有趣。

中途也是有遇上一些問題，下面會記錄一下，先把心得寫完。

在看到帶著自己域名的首頁顯示 Ubuntu default page 畫面提示 **It works!** 的瞬間，也在內心吶喊了一聲：It! Works! 然後幫它[截圖](https://images.plurk.com/1GZ5AU4XMcCbMx0W7xGmfv.jpg)。

把之前的作業丟幾個上去，並花了一點時間把作業修好後，開始亂玩一些有的沒的，接著想到應該把首頁換成自己的東西，不要留寫著 It works! 的 default page 在那邊，於是用短短的時間先用舊作改出一點簡單的東西就放上去當成個人頁面，並讓首頁有連結進入作業當成作品集這樣，之後再來慢慢修它們和重寫首頁吧。

## 遇到的問題與解決

1. 我的 URL/todo 會跑出我放todo的資料夾目錄？！但 URL//twitch-top-games 卻是正常顯示該作業的 html 的畫面。
-> 發現是 html 的檔名問題，要把它從本來的 todo.html 改成 index.html。

2. 網頁的中文顯示為亂碼。
-> 其實是助教之前便已提醒過的事情，也就是忘記加 `<meta charset="utf-8">` 了，以致於網頁無法正常顯示中文。

3. 安裝 certbot 時發生錯誤。
>ubuntu@ip-xx:~$ `sudo apt install python-certbot-nginx`
……
>E: Package 'python-certbot-nginx' has no installation candidate
-> 改用較新的 python3 即可 `sudo apt-get install python3-certbot-nginx`
其實錯誤提示有寫解法，但因為有點緊張它，以致於在查資料中過了一些時間才看到。

4. 大部分的時候只能用 CLI 做事，覺得好抖。
-> 適應一下就好。

## 結尾

在看到 Ubuntu default page 出現，開心之餘忍不住把這個畫面丟給親友看，他回說：「好像很厲害？」接著刪除重傳「好像很厲害！」某種程度也是沒打錯標點符號，這個簡單的畫面對自己來說很感動，但沒相關經驗的人應該很無感，無法理解是經過多少努力與步驟才能把主機和網域串起來、接著擴展出更多元的功能與頁面。

這次用掉許多時間讀資料，但很顯然還是漏東漏西，網路架構還有好多東西要補，但無論如何有了自己架的網站已經是踏出重要的一步，來日方長，繼續學習吧。

### 參考資料
1. [EC2 上的 Ubuntu](https://www.ioa.tw/AWS/EC2-Ubuntu.html)
2. [Amazon VPC 練習 - Day07 ](https://ithelp.ithome.com.tw/articles/10234482)
3. [[AWS] 自動佈署、擴展與高可用性實作筆記](https://blog.hinablue.me/aws-auto-deployment-with-as-elb-and-ha/)
4. [小型雲系統的安裝與基礎設定](http://linux.vbird.org/linux_server/0107cloudandvm.php)
5. [【PHP on AWS】Day 15 MYSQL 管理上的難題](https://www.nextlink.cloud/architect-column/php-on-aws-15/)
6. [[AWS][教學] AWS基本使用#01. AWS免費方案介紹](https://www.youtube.com/watch?v=roIzxMx-XHc)
7. [[week 14] 網站部署 - 設定 AWS EC2 遠端主機 + Ubuntu LAMP 環境 + phpMyAdmin](https://hackmd.io/@Heidi-Liu/note-website-deployment#%E9%83%A8%E7%BD%B2%E5%BF%83%E5%BE%97)
8. [在 AWS 上面部署 LEMP server](https://github.com/Lidemy/mentor-program-4th-Lauviah0622/blob/master/homeworks/week14/hw2.md)
